syntax = "proto3";
package phoenix;

import "field.proto";
import "keys.proto";
import "note.proto";
import "transaction.proto";

enum Status {
  OK = 0;
  ERROR = 1;
}

message FetchDecryptedNoteRequest {
  Idx pos = 1;
  ViewKey vk = 2;
}

message FetchNoteResponse {
  Status status = 1;
  Note note = 2;
}

message VerifyTransactionResponse { Status status = 1; }

message VerifyTransactionRootRequest {
  Transaction transaction = 1;
  Scalar root = 2;
}

message VerifyTransactionRootResponse { Status status = 1; }

message StoreTransactionsRequest { repeated Transaction transactions = 1; }

message StoreTransactionsResponse {
  Status status = 1;
  Scalar root = 2;
}

message GetFeeResponse { uint64 fee = 1; }

message SetFeePkRequest {
  Transaction transaction = 1;
  PublicKey pk = 2;
}

message SetFeePkResponse {
  Status status = 1;
  Transaction transaction = 2;
}

message KeysResponse {
  ViewKey vk = 1;
  PublicKey pk = 2;
}

service Phoenix {
  rpc Keys(SecretKey) returns (KeysResponse) {}

  rpc FetchNote(Idx) returns (FetchNoteResponse) {}
  rpc FetchDecryptedNote(FetchDecryptedNoteRequest)
      returns (FetchNoteResponse) {}

  rpc VerifyTransaction(Transaction) returns (VerifyTransactionResponse) {}
  rpc VerifyTransactionRoot(VerifyTransactionRootRequest)
      returns (VerifyTransactionRootResponse) {}
  rpc StoreTransactions(StoreTransactionsRequest)
      returns (StoreTransactionsResponse) {}

  rpc GetFee(Transaction) returns (GetFeeResponse) {}
  rpc SetFeePk(SetFeePkRequest) returns (SetFeePkResponse) {}
}
