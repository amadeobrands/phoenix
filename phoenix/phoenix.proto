syntax = "proto3";
package phoenix;

import "field.proto";
import "keys.proto";
import "note.proto";
import "transaction.proto";

message FetchDecryptedNoteRequest {
  Idx pos = 1;
  ViewKey vk = 2;
}

message VerifyTransactionResponse {}

message VerifyTransactionRootRequest {
  Transaction transaction = 1;
  Scalar root = 2;
}

message VerifyTransactionRootResponse {}

message StoreTransactionsRequest { repeated Transaction transactions = 1; }

message SetFeePkRequest {
  Transaction transaction = 1;
  PublicKey pk = 2;
}

message KeysResponse {
  ViewKey vk = 1;
  PublicKey pk = 2;
}

service Phoenix {
  rpc Keys(SecretKey) returns (KeysResponse) {}

  rpc FetchNote(Idx) returns (Note) {}
  rpc FetchDecryptedNote(FetchDecryptedNoteRequest) returns (Note) {}

  rpc VerifyTransaction(Transaction) returns (VerifyTransactionResponse) {}
  rpc VerifyTransactionRoot(VerifyTransactionRootRequest)
      returns (VerifyTransactionRootResponse) {}
  rpc StoreTransactions(StoreTransactionsRequest) returns (Scalar) {}
  rpc SetFeePk(SetFeePkRequest) returns (Transaction) {}
}
